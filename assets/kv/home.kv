#:import dp kivy.metrics.dp
#:import sp kivy.metrics.sp

<HomeScreen>:
    MDScrollView:
        MDBoxLayout:
            orientation: "vertical"
            padding: dp(16)
            spacing: dp(16)
            size_hint_y: None
            height: self.minimum_height

            MDCard:
                radius: [20]
                elevation: 2
                size_hint_y: None
                height: dp(260)
                padding: 0

                Carousel:
                    id: photos_carousel
                    loop: True
                    direction: "right"

            # SEPARADOR
            Widget:
                size_hint_y: None
                height: dp(12)

            # DESAFIO SEMANAL
            MDCard:
                radius: [20]
                elevation: 2
                padding: dp(16)
                adaptive_height: True

                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(8)
                    adaptive_height: True

                    MDBoxLayout:
                        spacing: dp(8)
                        adaptive_height: True

                        MDIcon:
                            icon: "trophy-outline"
                            size_hint: None, None
                            size: dp(36), dp(36)

                        MDBoxLayout:
                            orientation: "vertical"
                            adaptive_height: True

                            MDLabel:
                                text: root.weekly_title
                                font_size: sp(21)
                                bold: True
                                size_hint_y: None
                                height: self.texture_size[1]

                            MDLabel:
                                text: root.weekly_desc
                                theme_text_color: "Secondary"
                                font_size: sp(15)
                                size_hint_y: None
                                height: self.texture_size[1]

                    MDLinearProgressIndicator:
                        id: weekly_progress
                        size_hint_y: None
                        height: dp(12)
                        value: root.progress_percent

                    MDBoxLayout:
                        size_hint_y: None
                        height: dp(40)
                        spacing: dp(10)

                        MDLabel:
                            id: weekly_progress_label
                            text: root.progress_text
                            theme_text_color: "Secondary"

                        Widget:

                        MDButton:
                            style: "filled"
                            on_release: root.register_recycling()
                            MDButtonText:
                                text: "Registrar"

                        MDButton:
                            style: "outlined"
                            on_release: root.reset_weekly_progress()
                            MDButtonText:
                                text: "Reiniciar"

            # SEPARADOR
            Widget:
                size_hint_y: None
                height: dp(12)

            # Bloque 3: Métricas (INFO PARA PRESENTACIÓN)
            MDGridLayout:
                cols: 3 if self.width >= dp(480) else 2
                spacing: dp(12)
                size_hint_y: None
                height: self.minimum_height

                # --- 1. Botellas recicladas ---
                MetricCard:
                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(6)

                        MDIcon:
                            icon: "recycle-variant"
                            size_hint_y: None
                            height: dp(32)

                        MDLabel:
                            text: "248"
                            theme_font_size: "Custom"
                            font_size: sp(22)
                            halign: "center"

                        MDLabel:
                            text: "Botellas recicladas"
                            theme_text_color: "Secondary"
                            halign: "center"

                # --- 2. Puntos verdes registrados ---
                MetricCard:
                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(6)

                        MDIcon:
                            icon: "map-marker-radius"
                            size_hint_y: None
                            height: dp(32)

                        MDLabel:
                            text: "16"
                            theme_font_size: "Custom"
                            font_size: sp(22)
                            halign: "center"

                        MDLabel:
                            text: "Puntos verdes registrados"
                            theme_text_color: "Secondary"
                            halign: "center"

                # --- 3. Plantas sembradas ---
                MetricCard:
                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(6)

                        MDIcon:
                            icon: "sprout"
                            size_hint_y: None
                            height: dp(32)

                        MDLabel:
                            text: "32"
                            theme_font_size: "Custom"
                            font_size: sp(22)
                            halign: "center"

                        MDLabel:
                            text: "Plantas sembradas"
                            theme_text_color: "Secondary"
                            halign: "center"

